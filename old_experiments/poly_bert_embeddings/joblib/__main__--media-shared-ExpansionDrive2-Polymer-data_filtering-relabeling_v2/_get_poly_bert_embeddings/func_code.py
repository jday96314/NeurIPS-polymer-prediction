# first line: 887
@Memory(location=_POLY_BERT_CACHE_DIR, verbose=0).cache
def _get_poly_bert_embeddings(smiles_df: pd.DataFrame, polybert_embedding_dim_count: int):
    polyBERT = SentenceTransformer('kuelumbus/polyBERT')
    embeddings = polyBERT.encode(smiles_df['SMILES'].to_list())
    
    embedding_col_names = [f'polyBERT_{index}' for index in range(len(embeddings[0]))]
    features_df = pd.DataFrame(embeddings, columns=embedding_col_names)
    
    ranked_features = ['polyBERT_360', 'polyBERT_68', 'polyBERT_32', 'polyBERT_207', 'polyBERT_127', 'polyBERT_348', 'polyBERT_189', 'polyBERT_285', 'polyBERT_424', 'polyBERT_415', 'polyBERT_51', 'polyBERT_384', 'polyBERT_210', 'polyBERT_492', 'polyBERT_204', 'polyBERT_410', 'polyBERT_203', 'polyBERT_402', 'polyBERT_50', 'polyBERT_88', 'polyBERT_457', 'polyBERT_584', 'polyBERT_112', 'polyBERT_295', 'polyBERT_544', 'polyBERT_190', 'polyBERT_408', 'polyBERT_338', 'polyBERT_54', 'polyBERT_179', 'polyBERT_246', 'polyBERT_471', 'polyBERT_540', 'polyBERT_280', 'polyBERT_428', 'polyBERT_512', 'polyBERT_82', 'polyBERT_275', 'polyBERT_417', 'polyBERT_154', 'polyBERT_449', 'polyBERT_554', 'polyBERT_74', 'polyBERT_396', 'polyBERT_91', 'polyBERT_208', 'polyBERT_375', 'polyBERT_288', 'polyBERT_201', 'polyBERT_400', 'polyBERT_289', 'polyBERT_134', 'polyBERT_468', 'polyBERT_183', 'polyBERT_228', 'polyBERT_0', 'polyBERT_171', 'polyBERT_436', 'polyBERT_95', 'polyBERT_151', 'polyBERT_297', 'polyBERT_36', 'polyBERT_186', 'polyBERT_316', 'polyBERT_81', 'polyBERT_463', 'polyBERT_302', 'polyBERT_227', 'polyBERT_78', 'polyBERT_168', 'polyBERT_145', 'polyBERT_3', 'polyBERT_170', 'polyBERT_423', 'polyBERT_571', 'polyBERT_301', 'polyBERT_176', 'polyBERT_432', 'polyBERT_60', 'polyBERT_552', 'polyBERT_262', 'polyBERT_300', 'polyBERT_93', 'polyBERT_169', 'polyBERT_191', 'polyBERT_160', 'polyBERT_503', 'polyBERT_380', 'polyBERT_451', 'polyBERT_548', 'polyBERT_57', 'polyBERT_570', 'polyBERT_332', 'polyBERT_441', 'polyBERT_99', 'polyBERT_478', 'polyBERT_477', 'polyBERT_394', 'polyBERT_58', 'polyBERT_308', 'polyBERT_118', 'polyBERT_85', 'polyBERT_101', 'polyBERT_84', 'polyBERT_475', 'polyBERT_440', 'polyBERT_299', 'polyBERT_397', 'polyBERT_325', 'polyBERT_327', 'polyBERT_244', 'polyBERT_1', 'polyBERT_100', 'polyBERT_209', 'polyBERT_343', 'polyBERT_109', 'polyBERT_226', 'polyBERT_21', 'polyBERT_370', 'polyBERT_367', 'polyBERT_23', 'polyBERT_193', 'polyBERT_476', 'polyBERT_369', 'polyBERT_556', 'polyBERT_357', 'polyBERT_335', 'polyBERT_511', 'polyBERT_597', 'polyBERT_494', 'polyBERT_309', 'polyBERT_517', 'polyBERT_562', 'polyBERT_376', 'polyBERT_165', 'polyBERT_336', 'polyBERT_293', 'polyBERT_546', 'polyBERT_158', 'polyBERT_42', 'polyBERT_591', 'polyBERT_218', 'polyBERT_215', 'polyBERT_458', 'polyBERT_383', 'polyBERT_216', 'polyBERT_337', 'polyBERT_253', 'polyBERT_153', 'polyBERT_496', 'polyBERT_328', 'polyBERT_22', 'polyBERT_578', 'polyBERT_319', 'polyBERT_56', 'polyBERT_196', 'polyBERT_433', 'polyBERT_257', 'polyBERT_86', 'polyBERT_486', 'polyBERT_281', 'polyBERT_594', 'polyBERT_497', 'polyBERT_7', 'polyBERT_66', 'polyBERT_15', 'polyBERT_286', 'polyBERT_290', 'polyBERT_37', 'polyBERT_557', 'polyBERT_312', 'polyBERT_141', 'polyBERT_506', 'polyBERT_304', 'polyBERT_598', 'polyBERT_40', 'polyBERT_466', 'polyBERT_10', 'polyBERT_320', 'polyBERT_264', 'polyBERT_500', 'polyBERT_72', 'polyBERT_501', 'polyBERT_76', 'polyBERT_270', 'polyBERT_434', 'polyBERT_374', 'polyBERT_16', 'polyBERT_558', 'polyBERT_550', 'polyBERT_454', 'polyBERT_260', 'polyBERT_177', 'polyBERT_138', 'polyBERT_28', 'polyBERT_2', 'polyBERT_461', 'polyBERT_223', 'polyBERT_499', 'polyBERT_229', 'polyBERT_513', 'polyBERT_233', 'polyBERT_89', 'polyBERT_490', 'polyBERT_19', 'polyBERT_219', 'polyBERT_514', 'polyBERT_135', 'polyBERT_132', 'polyBERT_474', 'polyBERT_483', 'polyBERT_70', 'polyBERT_339', 'polyBERT_491', 'polyBERT_41', 'polyBERT_46', 'polyBERT_493', 'polyBERT_504', 'polyBERT_157', 'polyBERT_391', 'polyBERT_373', 'polyBERT_566', 'polyBERT_102', 'polyBERT_5', 'polyBERT_205', 'polyBERT_47', 'polyBERT_314', 'polyBERT_479', 'polyBERT_65', 'polyBERT_156', 'polyBERT_63', 'polyBERT_581', 'polyBERT_545', 'polyBERT_276', 'polyBERT_291', 'polyBERT_379', 'polyBERT_429', 'polyBERT_108', 'polyBERT_582', 'polyBERT_350', 'polyBERT_352', 'polyBERT_361', 'polyBERT_251', 'polyBERT_49', 'polyBERT_324', 'polyBERT_27', 'polyBERT_247', 'polyBERT_509', 'polyBERT_577', 'polyBERT_284', 'polyBERT_182', 'polyBERT_372', 'polyBERT_206', 'polyBERT_508', 'polyBERT_87', 'polyBERT_242', 'polyBERT_147', 'polyBERT_534', 'polyBERT_188', 'polyBERT_237', 'polyBERT_502', 'polyBERT_273', 'polyBERT_403', 'polyBERT_298', 'polyBERT_307', 'polyBERT_368', 'polyBERT_61', 'polyBERT_267', 'polyBERT_541', 'polyBERT_322', 'polyBERT_580', 'polyBERT_527', 'polyBERT_238', 'polyBERT_358', 'polyBERT_192', 'polyBERT_199', 'polyBERT_555', 'polyBERT_498', 'polyBERT_495', 'polyBERT_94', 'polyBERT_202', 'polyBERT_453', 'polyBERT_442', 'polyBERT_75', 'polyBERT_38', 'polyBERT_55', 'polyBERT_488', 'polyBERT_29', 'polyBERT_425', 'polyBERT_124', 'polyBERT_447', 'polyBERT_366', 'polyBERT_259', 'polyBERT_404', 'polyBERT_387', 'polyBERT_146', 'polyBERT_537', 'polyBERT_221', 'polyBERT_536', 'polyBERT_178', 'polyBERT_437', 'polyBERT_572', 'polyBERT_163', 'polyBERT_287', 'polyBERT_392', 'polyBERT_45', 'polyBERT_531', 'polyBERT_507', 'polyBERT_243', 'polyBERT_465', 'polyBERT_567', 'polyBERT_510', 'polyBERT_266', 'polyBERT_444', 'polyBERT_194', 'polyBERT_388', 'polyBERT_330', 'polyBERT_586', 'polyBERT_9', 'polyBERT_6', 'polyBERT_122', 'polyBERT_313', 'polyBERT_589', 'polyBERT_239', 'polyBERT_344', 'polyBERT_549', 'polyBERT_200', 'polyBERT_418', 'polyBERT_574', 'polyBERT_560', 'polyBERT_155', 'polyBERT_416', 'polyBERT_214', 'polyBERT_363', 'polyBERT_575', 'polyBERT_482', 'polyBERT_174', 'polyBERT_356', 'polyBERT_305', 'polyBERT_181', 'polyBERT_347', 'polyBERT_217', 'polyBERT_371', 'polyBERT_184', 'polyBERT_364', 'polyBERT_282', 'polyBERT_354', 'polyBERT_590', 'polyBERT_44', 'polyBERT_161', 'polyBERT_59', 'polyBERT_144', 'polyBERT_345', 'polyBERT_180', 'polyBERT_470', 'polyBERT_129', 'polyBERT_469', 'polyBERT_526', 'polyBERT_148', 'polyBERT_125', 'polyBERT_113', 'polyBERT_248', 'polyBERT_351', 'polyBERT_92', 'polyBERT_24', 'polyBERT_43', 'polyBERT_473', 'polyBERT_52', 'polyBERT_409', 'polyBERT_349', 'polyBERT_220', 'polyBERT_274', 'polyBERT_98', 'polyBERT_103', 'polyBERT_53', 'polyBERT_587', 'polyBERT_487', 'polyBERT_543', 'polyBERT_412', 'polyBERT_67', 'polyBERT_230', 'polyBERT_321', 'polyBERT_283', 'polyBERT_30', 'polyBERT_136', 'polyBERT_104', 'polyBERT_445', 'polyBERT_419', 'polyBERT_73', 'polyBERT_456', 'polyBERT_123', 'polyBERT_64', 'polyBERT_333', 'polyBERT_386', 'polyBERT_265', 'polyBERT_472', 'polyBERT_164', 'polyBERT_481', 'polyBERT_128', 'polyBERT_489', 'polyBERT_198', 'polyBERT_568', 'polyBERT_406', 'polyBERT_547', 'polyBERT_20', 'polyBERT_389', 'polyBERT_271', 'polyBERT_225', 'polyBERT_167', 'polyBERT_35', 'polyBERT_579', 'polyBERT_551', 'polyBERT_278', 'polyBERT_139', 'polyBERT_272', 'polyBERT_166', 'polyBERT_398', 'polyBERT_133', 'polyBERT_515', 'polyBERT_8', 'polyBERT_83', 'polyBERT_80', 'polyBERT_462', 'polyBERT_378', 'polyBERT_317', 'polyBERT_310', 'polyBERT_268', 'polyBERT_599', 'polyBERT_14', 'polyBERT_279', 'polyBERT_79', 'polyBERT_254', 'polyBERT_411', 'polyBERT_39', 'polyBERT_329', 'polyBERT_185', 'polyBERT_519', 'polyBERT_25', 'polyBERT_107', 'polyBERT_521', 'polyBERT_120', 'polyBERT_435', 'polyBERT_152', 'polyBERT_385', 'polyBERT_197', 'polyBERT_71', 'polyBERT_443', 'polyBERT_353', 'polyBERT_480', 'polyBERT_126', 'polyBERT_342', 'polyBERT_121', 'polyBERT_77', 'polyBERT_459', 'polyBERT_18', 'polyBERT_583', 'polyBERT_359', 'polyBERT_110', 'polyBERT_13', 'polyBERT_323', 'polyBERT_69', 'polyBERT_296', 'polyBERT_306', 'polyBERT_595', 'polyBERT_341', 'polyBERT_255', 'polyBERT_563', 'polyBERT_175', 'polyBERT_505', 'polyBERT_533', 'polyBERT_539', 'polyBERT_245', 'polyBERT_522', 'polyBERT_250', 'polyBERT_431', 'polyBERT_414', 'polyBERT_173', 'polyBERT_224', 'polyBERT_381', 'polyBERT_149', 'polyBERT_455', 'polyBERT_114', 'polyBERT_249', 'polyBERT_421', 'polyBERT_426', 'polyBERT_240', 'polyBERT_365', 'polyBERT_172', 'polyBERT_117', 'polyBERT_318', 'polyBERT_485', 'polyBERT_211', 'polyBERT_467', 'polyBERT_355', 'polyBERT_382', 'polyBERT_464', 'polyBERT_256', 'polyBERT_4', 'polyBERT_460', 'polyBERT_520', 'polyBERT_346', 'polyBERT_390', 'polyBERT_393', 'polyBERT_62', 'polyBERT_576', 'polyBERT_232', 'polyBERT_524', 'polyBERT_115', 'polyBERT_131', 'polyBERT_484', 'polyBERT_334', 'polyBERT_377', 'polyBERT_303', 'polyBERT_535', 'polyBERT_31', 'polyBERT_142', 'polyBERT_222', 'polyBERT_407', 'polyBERT_263', 'polyBERT_315', 'polyBERT_159', 'polyBERT_326', 'polyBERT_592', 'polyBERT_111', 'polyBERT_565', 'polyBERT_162', 'polyBERT_529', 'polyBERT_569', 'polyBERT_340', 'polyBERT_518', 'polyBERT_235', 'polyBERT_97', 'polyBERT_446', 'polyBERT_150', 'polyBERT_399', 'polyBERT_422', 'polyBERT_241', 'polyBERT_516', 'polyBERT_187', 'polyBERT_137', 'polyBERT_195', 'polyBERT_561', 'polyBERT_12', 'polyBERT_538', 'polyBERT_116', 'polyBERT_236', 'polyBERT_252', 'polyBERT_525', 'polyBERT_401', 'polyBERT_564', 'polyBERT_34', 'polyBERT_105', 'polyBERT_413', 'polyBERT_11', 'polyBERT_106', 'polyBERT_234', 'polyBERT_530', 'polyBERT_277', 'polyBERT_405', 'polyBERT_450', 'polyBERT_438', 'polyBERT_213', 'polyBERT_588', 'polyBERT_420', 'polyBERT_212', 'polyBERT_90', 'polyBERT_439', 'polyBERT_528', 'polyBERT_596', 'polyBERT_292', 'polyBERT_258', 'polyBERT_261', 'polyBERT_430', 'polyBERT_311', 'polyBERT_17', 'polyBERT_26', 'polyBERT_96', 'polyBERT_143', 'polyBERT_119', 'polyBERT_130', 'polyBERT_532', 'polyBERT_395', 'polyBERT_542', 'polyBERT_559', 'polyBERT_33', 'polyBERT_593', 'polyBERT_427', 'polyBERT_294', 'polyBERT_48', 'polyBERT_452', 'polyBERT_573', 'polyBERT_585', 'polyBERT_523', 'polyBERT_362', 'polyBERT_553', 'polyBERT_140', 'polyBERT_269', 'polyBERT_448', 'polyBERT_331', 'polyBERT_231']
    features_df = features_df[ranked_features[:polybert_embedding_dim_count]]

    return features_df
